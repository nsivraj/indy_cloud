<html>
<head>
<title>Digital Identifiers</title>
<script>
  //document.getElementById('issuerStep1').addEventListener('click', issuerStep1);
  var restProtocol = 'http';
  var restHost = 'localhost';
  var restPort = 9000;
  var agentData = {};

  async function credentialApi(action) {

    let actionMethod = 'GET'
    let actionUri = 'api/'
    let actionBody = ''

    if(action === 'createTrusteeWallet') {
      actionUri = actionUri + 'trustee/createWallet/0'
    } else if(action === 'createAuthorWallet') {
      actionUri = actionUri + 'author/createWallet/0'
    } else if(action === 'createEndorserWallet') {
      actionUri = actionUri + 'endorser/createWallet/0'
    } else if(action === 'createProverWallet') {
      actionUri = actionUri + 'prover/createWallet/0'
    } else if(action === 'addAuthor') {
      actionMethod = 'POST'
      actionUri = actionUri + 'trustee/addAuthor/0'
      actionBody = JSON.stringify({
        trusteeDid: agentData.trusteeDid,
        authorDid: agentData.authorDid,
        authorVerkey: agentData.authorVerkey
      })
    } else if(action === 'addEndorser') {
      actionMethod = 'POST'
      actionUri = actionUri + 'trustee/addEndorser/0'
      actionBody = JSON.stringify({
        trusteeDid: agentData.trusteeDid,
        endorserDid: agentData.endorserDid,
        endorserVerkey: agentData.endorserVerkey
      })
    } else if(action === 'createSchema') {
      actionMethod = 'POST'
      actionUri = actionUri + 'author/createSchema/0'
      actionBody = JSON.stringify({
        endorserDid: agentData.endorserDid,
        authorDid: agentData.authorDid
      })
    } else if(action === 'signAndSubmitRequest') {
      actionMethod = 'POST'
      actionUri = actionUri + 'endorser/signAndSubmitRequest/0'
      actionBody = JSON.stringify({
        endorserDid: agentData.endorserDid,
        requestSignedByAuthor: agentData.signedSchemaRequest
      })
    } else if(action === 'createCredDef') {
      actionMethod = 'POST'
      actionUri = actionUri + 'author/createCredDef/0'
      actionBody = JSON.stringify({
        schemaJson: agentData.schemaJson,
        authorDid: agentData.authorDid
      })
    }

    const fetchOptions = {
      method: actionMethod,
      headers: {
        'Content-Type': 'application/json'
      }
    }
    if(actionMethod === 'POST') {
        fetchOptions.body = actionBody
    }

    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/${actionUri}`,
      fetchOptions
    )
    const answer = await response.json()
    console.log(action + " answer: ", answer)

    if(action === 'createTrusteeWallet') {
      agentData.trusteeDid = answer.trusteeDid
    } else if(action === 'createAuthorWallet') {
      agentData.authorDid = answer.authorDid
      agentData.authorVerkey = answer.authorVerkey
    } else if(action === 'createEndorserWallet') {
      agentData.endorserDid = answer.endorserDid
      agentData.endorserVerkey = answer.endorserVerkey
    } else if(action === 'createProverWallet') {
      agentData.proverDid = answer.proverDid
      agentData.proverVerkey = answer.proverVerkey
    } else if(action === 'addAuthor') {

    } else if(action === 'addEndorser') {

    } else if(action === 'createSchema') {
      agentData.signedSchemaRequest = answer.signedSchemaRequest
      agentData.schemaJson = answer.schemaJson
      agentData.schemaId = answer.schemaId
    }
  }


</script>
</head>
<body>
<h1>Power Of Digital Credentials</h1>
<button id="createTrusteeWallet" onclick="credentialApi('createTrusteeWallet')">Trustee: Step1 -- createTrusteeWallet</button>
</br><button id="createAuthorWallet" onclick="credentialApi('createAuthorWallet')">Author: Step2 -- createAuthorWallet</button>
</br><button id="createEndorserWallet" onclick="credentialApi('createEndorserWallet')">Endorser: Step3 -- createEndorserWallet</button>
</br><button id="createProverWallet" onclick="credentialApi('createProverWallet')">Prover: Step4 -- createProverWallet</button>
</br><button id="addAuthor" onclick="credentialApi('addAuthor')">Trustee: Step5 -- addAuthor</button>
</br><button id="addEndorser" onclick="credentialApi('addEndorser')">Trustee: Step6 -- addEndorser</button>
</br><button id="createSchema" onclick="credentialApi('createSchema')">Author: Step7 -- createSchema</button>
</br><button id="signAndSubmitRequest" onclick="credentialApi('signAndSubmitRequest')">Endorser: Step8 -- signAndSubmitRequest</button>
</br><button id="createCredDef" onclick="credentialApi('createCredDef')">Author: Step9 -- createCredDef</button>
</br><button id="createMasterSecret" onclick="credentialApi('createMasterSecret')">Prover: Step10 -- createMasterSecret</button>
</br><button id="createCredOffer" onclick="credentialApi('createCredOffer')">Author: Step11 -- createCredOffer</button>
</br><button id="createCredRequest" onclick="credentialApi('createCredRequest')">Prover: Step12 -- createCredRequest</button>
</br><button id="createCredential" onclick="credentialApi('createCredential')">Author: Step13 -- createCredential</button>
</br><button id="saveCredential" onclick="credentialApi('saveCredential')">Prover: Step14 -- saveCredential</button>
</br><button id="createProofRequest" onclick="credentialApi('createProofRequest')">Verifier: Step15 -- createProofRequest</button>
</br><button id="createProof" onclick="credentialApi('createProof')">Prover: Step16 -- createProof</button>
</br><button id="verifyProof" onclick="credentialApi('verifyProof')">Verifier: Step17 -- verifyProof</button>

<!--

  async function createTrusteeWallet() {
    step1Answer = await response.json()
    console.log("issue step1 answer: ", step1Answer)
  }

  async function proverStep2() {
    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/api/prover/step2/0`
    )
    step2Answer = await response.json()
    console.log("prover step2 answer: ", step2Answer)
  }

  async function issuerStep3() {
    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/api/issuer/step3/${step2Answer.walletId}/${step1Answer.credDefId}`
    )
    step3Answer = await response.json()
    console.log("issuer step3 answer: ", step3Answer)
  }

  async function proverStep4() {
    const step4Body = {
      credOffer: step3Answer.credOffer,
      credDefJson: step1Answer.credDefJson
    }
    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/api/prover/step4/${step2Answer.walletId}`, {
        method: 'POST',
        body: JSON.stringify(step4Body),
        headers: {
          'Content-Type': 'application/json'
        }
      }
    )
    step4Answer = await response.json()
    console.log("prover step4 answer: ", step4Answer)
  }

  async function issuerStep5() {
    const step5Body = {
      credOffer: step3Answer.credOffer,
      credReqJson: step4Answer.credReqJson
    }
    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/api/issuer/step5/${step2Answer.walletId}`, {
        method: 'POST',
        body: JSON.stringify(step5Body),
        headers: {
          'Content-Type': 'application/json'
        }
      }
    )
    step5Answer = await response.json()
    console.log("prover step5 answer: ", step5Answer)
  }


  async function proverStep6() {
    const step6Body = {
      credDefJson: step1Answer.credDefJson,
      credReqMetadataJson: step4Answer.credReqMetadataJson,
      credential: step5Answer.credential
    }
    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/api/prover/step6/${step2Answer.walletId}`, {
        method: 'POST',
        body: JSON.stringify(step6Body),
        headers: {
          'Content-Type': 'application/json'
        }
      }
    )
    step6Answer = await response.json()
    console.log("prover step6 answer: ", step6Answer)
  }

  async function verifierStep7() {
    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/api/verifier/step7/${step2Answer.walletId}`
    )
    step7Answer = await response.json()
    console.log("issuer step7 answer: ", step7Answer)
  }

  async function proverStep8() {
    // String proofReqJson = proofRequestData.get("proofReqJson").toString();
    // String credDefJson = proofRequestData.get("credDefJson").toString();
    // String credDefId = proofRequestData.get("credDefId").toString();
    // String schemaId = proofRequestData.get("schemaId").toString();
    // String schemaJson = proofRequestData.get("schemaJson").toString();

    const step8Body = {
      proofReqJson: step7Answer.proofRequestJson,
      credDefJson: step1Answer.credDefJson,
      credDefId: step1Answer.credDefId,
      schemaId: step1Answer.schemaId,
      schemaJson: step1Answer.schemaJson
    }
    const response = await fetch(
      `${restProtocol}://${restHost}:${restPort}/api/prover/step8/${step2Answer.walletId}`, {
        method: 'POST',
        body: JSON.stringify(step8Body),
        headers: {
          'Content-Type': 'application/json'
        }
      }
    )
    step8Answer = await response.json()
    console.log("prover step8 answer: ", step8Answer)

  }


-->
</body>
</html>